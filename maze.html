<!DOCTYPE html>
<html>
	<head>
		<title></title>
		<script src="jquery-2.1.1.js"></script>
		<link rel="stylesheet" href="bootstrap.css">
		<script src="bootstrap.js"></script>
	</head>
	<body>
		<pre id="out"></pre>
		<!-- <button class="dir_button button" value="left">Left</button>
		<button class="dir_button button" value="forward">Forward</button>
		<button class="dir_button button" value="right">Right</button> -->
		
		<div id="direction"></div>
		<div id="position"></div>
		<div id="log"></div>
		<button class="button" id="reset">Reset</button>

		<div class="row" style="text-align:center;">
			<div class="col-md-2"></div>
			<div class="col-md-8">
				<div class ="row">
					<div class="col-md-4"></div>
					<div class="col-md-4" id="forward_open">
						hello
					</div>
					<div class="col-md-4"></div>

				</div>
				<div class ="row">
					<div class="col-md-4" id="left_open">
						hello
					</div>
					<div class="col-md-4">
						<button class="dir_button btn" value="left">Left</button>
						<button class="dir_button btn" value="forward" id="forward">Forward</button>
						<button class="dir_button btn" value="right">Right</button>
					</div>
					<div class="col-md-4" id="right_open">
						hello
					</div>

				</div><div class ="row">
					<div class="col-md-4"></div>
					<div class="col-md-4" id="back_open">
						hello
					</div>
					<div class="col-md-4"></div>

				</div>
			</div>
			<div class="col-md-2"></div>
		</div>	

	</body>
</html>
<script type="text/javascript">
var bla;
var back_open;
var forward_open = 0;
var right_open = 0;
var left_open = 0;
var direction = 'south';
var pos = [0,0];
$(document).ready(function(){
	
	bla = maze(10,10);
	get_around();
	$(".dir_button").click(function(e){
		e.preventDefault();
		to = $(this).attr('value');
		if(to == 'left'){
			if(direction == 'south'){
				//pos[0] = pos[0] +1;
				direction = 'east';
			}
			else if(direction == 'north'){
				//pos[0] = pos[0] -1;
				direction = 'west';
			}
			else if(direction == 'east'){
				//pos[1] = pos[1] -1;
				direction = 'north';
			}
			else if(direction == 'west'){
				//pos[1] = pos[1] +1;
				direction = 'south';
			}
		}
		else if(to == 'right'){
			if(direction == 'south'){
				//pos[0] = pos[0] -1;
				direction = 'west';
			}
			else if(direction == 'north'){
				//pos[0] = pos[0] +1;
				direction = 'east';
			}
			else if(direction == 'east'){
				//pos[1] = pos[1] +1;
				direction = 'south';
			}
			else if(direction == 'west'){
				//pos[1] = pos[1] -1;
				direction = 'north';
			}
		}
		else if(to == 'forward'){

			if(forward_open == 0){
				alert("You cannot walk into a wall!")
			}
			else{
				if(direction == 'south'){
					pos[1] = pos[1] +1;
				}
				else if(direction == 'north'){
					pos[1] = pos[1] -1;
				}
				else if(direction == 'east'){
					pos[0] = pos[0] +1;
				}
				else if(direction == 'west'){
					pos[0] = pos[0] -1;
				}
			}
			if(pos[0] == (bla.x - 1) && pos[1] ==(bla.y-1)){
				document.getElementById('out').innerHTML= display(bla); 
				alert("YOU WIN!");
			}
		}
		// else if(to == 'back'){
		// 	if(direction == 'south'){
		// 		pos[1] = pos[1] -1;
		// 		direction = 'north';
		// 	}
		// 	else if(direction == 'north'){
		// 		pos[1] = pos[1] +1;
		// 		direction = 'south';
		// 	}
		// 	else if(direction == 'east'){
		// 		pos[0] = pos[0] -1;
		// 		direction = 'west';
		// 	}
		// 	else if(direction == 'west'){
		// 		pos[0] = pos[0] +1;
		// 		direction = 'east';
		// 	}
		// }

		get_around();
		$("#direction").text(direction);
		$("#position").text("x: "+pos[0]+ " y: "+pos[1]);

	});

	$("#reset").click(function(){
		pos[0] = 0;
		pos[1] = 0;
		direction = 'south';
		get_around();
		
	});
	function get_around(){
		
		
		var south_open = 0;
		for(var i = pos[1]; i <bla.y; i++){
			if(!bla.verti[i][pos[0]]){
				break;
			}
			south_open += 1;
		}

		
		var north_open = 0;
		for(var i = pos[1]-1; i >=0; i--){
			if(!bla.verti[i][pos[0]]){
				break;
			}
			north_open += 1;
		}

		
		var east_open = 0;
		for(var i = pos[0]; i < bla.x; i++){
			if(!bla.horiz[pos[1]][i]){
				break;
			}
			east_open += 1;
		}

		
		var west_open = 0;
		for(var i = pos[0] - 1; i >=0; i--){
			if(!bla.horiz[pos[1]][i]){
				break;
			}
			west_open += 1;
		}

		if(direction == 'south'){
			forward_open = south_open;
			back_open = north_open;
			left_open = east_open;
			right_open = west_open;
		}
		else if(direction == 'north'){
			forward_open = north_open;
			back_open = south_open;
			left_open = west_open;
			right_open = east_open;
		}
		else if(direction == 'east'){
			forward_open = east_open;
			back_open = west_open;
			right_open = south_open;
			left_open = north_open;
		}
		else if(direction == 'west'){
			forward_open = west_open;
			back_open = east_open;
			left_open = south_open;
			right_open = north_open;
		}
		if(forward_open > 0){
			$("#forward").removeClass("btn-danger");
			$("#forward").addClass("btn-success");
		}
		else{
			$("#forward").removeClass("btn-success");
			$("#forward").addClass("btn-danger");
		}
		console.log("north: " +north_open);
		console.log("south: " +south_open);
		console.log("east: " +east_open);
		console.log("west:" + west_open);
		console.log('');
		$("#forward_open").text(forward_open);
		$("#back_open").text(back_open);
		$("#left_open").text(left_open);
		$("#right_open").text(right_open);
		console.log("forward: " +forward_open);
		console.log("back: " +back_open);
		console.log("right: " +right_open);
		console.log("left:" + left_open);
		console.log('');
		
	}
	function maze(x,y) {
		var n=x*y-1;
		if (n<0) {alert("illegal maze dimensions");return;}
		var horiz =[]; for (var j= 0; j<x+1; j++) horiz[j]= [],
		    verti =[]; for (var j= 0; j<y+1; j++) verti[j]= [],
		    here = [Math.floor(Math.random()*x), Math.floor(Math.random()*y)],
		    path = [here],
		    unvisited = [];
		for (var j = 0; j<x+2; j++) {
			unvisited[j] = [];
			for (var k= 0; k<y+1; k++)
				unvisited[j].push(j>0 && j<x+1 && k>0 && (j != here[0]+1 || k != here[1]+1));
		}
		while (0<n) {
			var potential = [[here[0]+1, here[1]], [here[0],here[1]+1],
			    [here[0]-1, here[1]], [here[0],here[1]-1]];
			var neighbors = [];
			for (var j = 0; j < 4; j++)
				if (unvisited[potential[j][0]+1][potential[j][1]+1])
					neighbors.push(potential[j]);
			if (neighbors.length) {
				n = n-1;
				next= neighbors[Math.floor(Math.random()*neighbors.length)];
				unvisited[next[0]+1][next[1]+1]= false;
				if (next[0] == here[0])
					horiz[next[0]][(next[1]+here[1]-1)/2]= true;
				else 
					verti[(next[0]+here[0]-1)/2][next[1]]= true;
				path.push(here = next);
			} else 
				here = path.pop();
		}
		return {x: x, y: y, horiz: horiz, verti: verti};
	}
	 
	function display(m) {
		var text= [];
		for (var j= 0; j<m.x*2+1; j++) {
			var line= [];
			if (0 == j%2)
				for (var k=0; k<m.y*4+1; k++)
					if (0 == k%4) 
						line[k]= '+';
					else
						if (j>0 && m.verti[j/2-1][Math.floor(k/4)])
							line[k]= ' ';
						else
							line[k]= '-';
			else
				for (var k=0; k<m.y*4+1; k++)
					if (0 == k%4)
						if (k>0 && m.horiz[(j-1)/2][k/4-1])
							line[k]= ' ';
						else
							line[k]= '|';
					else
						line[k]= ' ';
			if (0 == j) line[1]= line[2]= line[3]= ' ';
			if (m.x*2-1 == j) line[4*m.y]= ' ';
			text.push(line.join('')+'\r\n');
		}
		return text.join('');
	}
	
	
});
</script>